<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TX:RP | Emergency Communications Center</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background-image: url('https://i.ibb.co/wzWKyGj/teccbac.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        .banner {
            background-color: #000000;
            color: white;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .banner img {
            height: 40px;
            margin-right: 20px;
        }
        .banner h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .time-display {
            font-size: 1.2em;
            font-weight: bold;
        }
        .content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .panel {
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            background-color: rgba(255, 255, 255, 0.8);
        }
        h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        button {
            margin: 5px;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            opacity: 0.8;
        }
        .red { background-color: #ff6b6b; color: white; }
        .green { background-color: #51cf66; color: white; }
        .yellow { background-color: #fcc419; color: black; }
        .blue { background-color: #339af0; color: white; }
        .list {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
            background-color: rgba(255, 255, 255, 0.9);
        }
        .list-item {
            cursor: pointer;
            padding: 10px;
            margin: 5px 0;
            background-color: rgba(248, 249, 250, 0.8);
            border-radius: 4px;
            transition: background-color 0.3s;
            border-bottom: 1px solid #ddd;
        }
        .list-item:last-child {
            border-bottom: none;
        }
        .list-item:hover {
            background-color: rgba(233, 236, 239, 0.8);
        }
        .panic {
            animation: panic 0.5s infinite;
        }
        @keyframes panic {
            0% { background-color: rgba(255, 107, 107, 0.8); }
            50% { background-color: rgba(51, 154, 240, 0.8); }
            100% { background-color: rgba(255, 107, 107, 0.8); }
        }
        .options {
            display: flex;
            justify-content: flex-end;
            margin-top: 5px;
        }
        .options button {
            margin-left: 5px;
            font-size: 0.8em;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            border-radius: 5px;
        }
        .modal-content h3 {
            margin-top: 0;
        }
        .modal-content input {
            width: 100%;
            padding: 5px;
            margin: 5px 0 15px 0;
        }
        .modal-content button {
            width: 100%;
        }
        .draggable {
            cursor: move;
        }
        .droppable {
            border: 2px dashed #aaa;
            min-height: 50px;
            margin-top: 10px;
        }
        .signal-100-banner {
            background-color: #ff0000;
            color: white;
            text-align: center;
            padding: 5px;
            font-weight: bold;
            display: none;
        }
        .signal-100-active {
            background-color: #ff6b6b;
        }
    </style>
</head>
<body>
    <div class="banner">
        <div style="display: flex; align-items: center;">
            <img src="https://i.ibb.co/Q8WcFQY/tecc.png" alt="TX:RP Logo">
            <h1>TX:RP Emergency Communications Center</h1>
        </div>
        <div class="time-display" id="timeDisplay"></div>
    </div>
    <div id="signal100Banner" class="signal-100-banner">SIGNAL 100 IS IN EFFECT</div>
    <div class="content">
        <div class="panel">
            <h2>Calls</h2>
            <button class="red" onclick="clearCalls()">Clear All Calls</button>
            <button class="green" onclick="showModal('call')">Make Call</button>
            <button id="signal100Button" class="yellow" onclick="toggleSignal100()">Signal 100</button>
            <div id="calls-list" class="list"></div>
        </div>
        <div class="panel">
            <h2>Units</h2>
            <button class="red" onclick="clearUnits()">Clear All Units</button>
            <button class="green" onclick="showModal('unit')">Make Unit</button>
            <div id="units-list" class="list"></div>
        </div>
        <div class="panel">
            <h2>BOLOs</h2>
            <button class="red" onclick="clearBolos()">Clear All BOLOs</button>
            <button class="green" onclick="showModal('bolo')">Make BOLO</button>
            <div id="bolos-list" class="list"></div>
        </div>
    </div>

    <div id="inputModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle"></h3>
            <div id="modalInputs"></div>
            <button class="green" onclick="submitModal()">Submit</button>
        </div>
    </div>

    <audio id="panicSound" src="https://dl.sndup.net/99yjh/Motorola%20Radio%20Tones%20(1)-[AudioTrimmercom].mp3"></audio>
    <audio id="signal100Sound" src="https://www.myinstants.com/media/sounds/sinal-100.mp3"></audio>

    <script>
        let calls = [];
        let units = [];
        let bolos = [];
        let selectedCall = null;
        let isSignal100Active = false;
        const panicSound = document.getElementById('panicSound');
        const signal100Sound = document.getElementById('signal100Sound');
        const modal = document.getElementById('inputModal');
        let currentModalType = '';

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { hour12: true, hour: 'numeric', minute: '2-digit', second: '2-digit' });
            document.getElementById('timeDisplay').textContent = timeString;
        }

        setInterval(updateTime, 1000);
        updateTime();

        function clearCalls() {
            calls = [];
            updateCallsList();
        }

        function clearUnits() {
            units = [];
            updateUnitsList();
        }

        function clearBolos() {
            bolos = [];
            updateBolosList();
        }

        function showModal(type) {
            currentModalType = type;
            const title = document.getElementById('modalTitle');
            const inputs = document.getElementById('modalInputs');
            inputs.innerHTML = '';

            if (type === 'call') {
                title.textContent = 'Make Call';
                inputs.innerHTML = `
                    <input type="text" id="callLocation" placeholder="Location">
                    <input type="text" id="callTitle" placeholder="Title">
                    <input type="text" id="callDescription" placeholder="Description">
                `;
            } else if (type === 'unit') {
                title.textContent = 'Make Unit';
                inputs.innerHTML = `
                    <input type="text" id="unitUsername" placeholder="Roblox Username">
                    <input type="text" id="unitCallsign" placeholder="Callsign">
                `;
            } else if (type === 'bolo') {
                title.textContent = 'Make BOLO';
                inputs.innerHTML = `
                    <input type="text" id="boloVehicle" placeholder="Vehicle Model">
                    <input type="text" id="boloPlate" placeholder="License Plate">
                    <input type="text" id="boloReason" placeholder="Reason">
                `;
            }

            modal.style.display = 'block';
        }

        function submitModal() {
            if (currentModalType === 'call') {
                const location = document.getElementById('callLocation').value;
                const title = document.getElementById('callTitle').value;
                const description = document.getElementById('callDescription').value;
                calls.push({ location, title, description, status: 'active', attachedUnits: [] });
                updateCallsList();
            } else if (currentModalType === 'unit') {
                const username = document.getElementById('unitUsername').value;
                const callsign = document.getElementById('unitCallsign').value;
                units.push({ username, callsign, status: '10-8' });
                updateUnitsList();
            } else if (currentModalType === 'bolo') {
                const vehicle = document.getElementById('boloVehicle').value;
                const plate = document.getElementById('boloPlate').value;
                const reason = document.getElementById('boloReason').value;
                bolos.push({ vehicle, plate, reason });
                updateBolosList();
            }
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        function updateCallsList() {
            const list = document.getElementById('calls-list');
            list.innerHTML = '';
            calls.forEach((call, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                if (call.status === 'panic') {
                    item.classList.add('panic');
                }
                item.innerHTML = `
                    <strong>${call.title}</strong> - ${call.location}
                    <br>${call.description}
                    <div class="options">
                        <button class="red" onclick="panicCall(${index})">PANIC</button>
                        <button class="green" onclick="code4Call(${index})">Code 4</button>
                    </div>
                    <div class="droppable" ondrop="drop(event, ${index})" ondragover="allowDrop(event)">
                        <strong>Attached Units:</strong> ${call.attachedUnits.map(u => u.callsign).join(', ')}
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function updateUnitsList() {
            const list = document.getElementById('units-list');
            list.innerHTML = '';
            units.forEach((unit, index) => {
                const item = document.createElement('div');
                item.className = 'list-item draggable';
                item.draggable = true;
                item.ondragstart = function(event) { drag(event, index); };
                item.innerHTML = `
                    <strong>${unit.callsign}</strong> (${unit.username}) - ${unit.status}
                    <div class="options">
                        <button class="yellow" onclick="setUnitStatus(${index}, '10-6')">10-6</button>
                        <button class="red" onclick="setUnitStatus(${index}, '10-7')">10-7</button>
                        <button class="green" onclick="setUnitStatus(${index}, '10-8')">10-8</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function updateBolosList() {
            const list = document.getElementById('bolos-list');
            list.innerHTML = '';
            bolos.forEach((bolo, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <strong>${bolo.vehicle}</strong> - ${bolo.plate}
                    <br>${bolo.reason}
                    <div class="options">
                        <button class="red" onclick="removeBolo(${index})">Remove</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function panicCall(index) {
            calls[index].status = 'panic';
            updateCallsList();
            panicSound.play();
        }

        function code4Call(index) {
            calls[index].attachedUnits.forEach(unit => {
                unit.status = '10-8';
            });
            calls.splice(index, 1);
            updateCallsList();
            updateUnitsList();
        }

        function setUnitStatus(index, status) {
            units[index].status = status;
            if (status === '10-7') {
                units.splice(index, 1);
            }
            updateUnitsList();
        }

        function removeBolo(index) {
            bolos.splice(index, 1);
            updateBolosList();
        }

        function drag(event, index) {
            event.dataTransfer.setData("text/plain", index);
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event, callIndex) {
            event.preventDefault();
            const unitIndex = event.dataTransfer.getData("text");
            const unit = units[unitIndex];
            const call = calls[callIndex];
            
            if (!call.attachedUnits.includes(unit)) {
                call.attachedUnits.push(unit);
                unit.status = 'attached';
                updateCallsList();
                updateUnitsList();
            }
        }

        function toggleSignal100() {
            isSignal100Active = !isSignal100Active;
            const banner = document.getElementById('signal100Banner');
            const button = document.getElementById('signal100Button');
            
            if (isSignal100Active) {
                banner.style.display = 'block';
                button.classList.add('signal-100-active');
                signal100Sound.play();
            } else {
                banner.style.display = 'none';
                button.classList.remove('signal-100-active');
            }
        }

        updateCallsList();
        updateUnitsList();
        updateBolosList();
    </script>
</body>
</html>
